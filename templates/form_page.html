{% extends 'base.html'%}

{%block title%}


{%endblock%}

{%block body%}



<ul class="nav nav-tabs justify-content-center nav-fill" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <a class="nav-link active" id="form" data-bs-toggle="tab" data-bs-target="#Entry form" type="button" role="tab" aria-controls="Entry form" aria-selected="true" href="/form_page">Entry form</a>
  </li>
  <li class="nav-item" role="presentation">
    <a class="nav-link" id="capex" data-bs-toggle="tab" data-bs-target="#capex" type="button" role="tab" aria-controls="capex" aria-selected="false" href="/capex">CAPEX</a>
  </li>
  <li class="nav-item" role="presentation">
    <a class="nav-link" id="efficiency" data-bs-toggle="tab" data-bs-target="#efficiency" type="button" role="tab" aria-controls="efficiency" aria-selected="false" href="/efficiency">Efficiency</a>
  </li>
    <li class="nav-item" role="presentation">
    <a class="nav-link" id="energy" data-bs-toggle="tab" data-bs-target="#energy" type="button" role="tab" aria-controls="energy" aria-selected="false" href="/energy">Energy Cost</a>
  </li>
    <li class="nav-item" role="presentation">
    <a class="nav-link" id="maintenance" data-bs-toggle="tab" data-bs-target="#maintenance" type="button" role="tab" aria-controls="maintenance" aria-selected="false" href="/maintenance">Maintenance Data</a>
  </li>
  </li>
    <li class="nav-item" role="presentation">
    <a class="nav-link" id="tco" data-bs-toggle="tab" data-bs-target="#tco" type="button" role="tab" aria-controls="tco" aria-selected="false" href="/tco">TCO</a>
  </li>
</ul>
<div class="tab-content" id="myTabContent">
  <div class="tab-pane fade show active" id="form" role="tabpanel" aria-labelledby="Entry form"></div>
  <div class="tab-pane fade" id="capex" role="tabpanel" aria-labelledby="capex"></div>
  <div class="tab-pane fade" id="Efficiency" role="tabpanel" aria-labelledby="Efficiency"></div>
  <div class="tab-pane fade" id="energy" role="tabpanel" aria-labelledby="energy"></div>
  <div class="tab-pane fade" id="maintenance" role="tabpanel" aria-labelledby="maintenance"></div>
  <div class="tab-pane fade" id="tco" role="tabpanel" aria-labelledby="tco"></div>
</div>



<section class="container" style="margin-left:15px;">

  <div class="input1">
    <legend align="left"><b>Unit data</b></legend>
    <form action="/form_page/add_component" method="POST" name="unit_data" autocomplete="off" id="unit_data">
          <fieldset>
<div class="form-row">
    <div class="col-md-13 mb-3">


<table>
<tr>

 <td>

<!--<datalist id="component">-->

<select class="form-select form-select-sm" name="component" id="component" required>
        <option value="" disabled selected>Component name</option>
        <optgroup label="Main Equipment">
            {% for a in main_eq%}
            <option>{{a}}
            {% endfor %}
        </optgroup>
        <optgroup label="Driver Type">
            {% for a in dr_eq%}
            <option>{{a}}
            {% endfor %}
        <optgroup label="Electrical Equipment">
            {% for a in el_eq%}
            <option>{{a}}
            {% endfor %}
         <optgroup label="Other">
            {% for a in ot_eq%}
            <option>{{a}}
            {% endfor %}
         <optgroup label="Non equipment scope">
            {% for a in non_eq%}
            <option>{{a}}
            {% endfor %}
    </select>

<!--</datalist>-->
		</select></td>
    </tr>
    <tr>
   <td> <input type="number" name="component_price" id="component_price" placeholder="Component price" min=0 step="100" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Component price'">
   </td>
    </tr>
    <tr>
    <td><input type="text" name="comments" id="comments" placeholder="Comments" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Comments'"></td>
</tr>
</table>
    <button type="submit" class="btn btn-outline-primary btn-sm" onclick="document.forms.unit_data.submit()" style="width: 150px;">Add component</button>
    <!--<button type="submit" class="btn btn-primary btn-sm" onclick="return getComponent()" style="width: 150px;">Add component</button>-->
<p><div style="margin-bottom:30px;"><a class="btn btn-outline-warning btn-sm" onclick="window.open('/select_conf','Select print option','width=400,height=400');" href='/reset'>Select configuration</a></div></p>
          </fieldset>
        </form>



  </div>

  <div class="tab1">

      <table class="table table-striped table-sm">
          <!--<thead>-->
            <!--<tr>-->
              <!--<th scope="col"></th>-->
              <!--<th scope="col">Component</th>-->
                <!--<th scope="col">Component price</th>-->
                <!--<th scope="col">Comments</th>-->
                <!--<th scope="col"></th>-->
                 <!--</tr>-->
          <!--</thead>-->
     <tbody>
     {% for i in user_components %}
            <tr >
              <td class="counterCell"></td>
              <td>{{i[0]}}</td>
              <td>{{i[1]}} {{currency}}</td>
                 <td>{{i[2]}}</td>
                <td align="right"><a class="btn btn-outline-warning btn-sm" href='/form_page/{{i[3]}}/del'>Delete</a></td>
                 </tr>
     {% endfor %}
          </tbody>
        </table>
      <b>Total CAPEX Cost: {{total_capex_direct}} {{currency}}</b>
  </div>

    <div class="image_capex">
    {% if total_capex_direct==0 %}
    <div style="margin-left:300px; margin-top:50px;">No figure to display</div>
    {%else%}
    <img src="{{url_for('static', filename='capex2.png')}}" align="middle" alt="Capex pic" />
<!--width="640" height="480"-->
    {%endif%}

  </div>
  <div class="input2">
   <script>
    function autofill(){
    var x = document.getElementById('main_type').value;
    if(x=='Annual Maintenance-Spares')
    {
        document.getElementById("period").value= 1;
    }
    </script>
    <legend align="left"><b>Maintenance</b></legend>
    <form action="/form_page/add_maintenance" method="POST" name="maintenance" autocomplete="off" id="maintenance">
     <fieldset>
        <div class="form-row">
    <div class="col-md-4 mb-3">
<table>

   <tr>
       <td><input name="main_type" list=maintenances placeholder="Maintenance type" onchange="autofill()" id='main_type'>
<datalist id=maintenances>
 <label>
  or select from the list:
  <select name=main_type>
   <option value="">
   <option>Annual Maintenance-Spares
   <option>Major Overhaul-Spares
   <option>Labor costs
  </select>
 </label>
</datalist></td>
   </tr>


<tr>
    <td><input type="number" name="period" id="period" placeholder="Periodity,year" min=0 class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Periodity,year'">
    </td>
</tr>
<tr>
    <td><input type="number" name="main_price" id="main_price" placeholder="Maintenance price" min=0 step="100" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Maintenance price'">
</td>
</tr>
<tr>
<td>    <input type="text" name="main_comments" id="main_comments" placeholder="Comments" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Comments'">
</td>
</tr>
<tr>	<td>
        <button type="submit" class="btn btn-outline-primary btn-sm" onclick="document.forms.maintenance.submit()" style="width: 150px;">Add maintenance</button>

</td>
</tr>
</table>
    </fieldset>
    </form>

</>

  </div>
  <div class="tab2">
      <table class="table table-striped table-sm">

     <tbody>
     <!--{% for j in maintenances %}-->
            <!--<tr height="15px">-->
              <!--<td class="counterCell"></td>-->
              <!--<td>{{j.main_type}}</td>-->
              <!--<td>{{j.period}}</td>-->
              <!--<td>{{j.main_price}}</td>-->
                <!--<td>{{j.main_comments}}</td>-->
              <!--<td><a class="btn btn-warning" href='/form_page/{{j.id}}/del_man'>Delete</a></td>-->
            <!--</tr>-->
     <!--{% endfor %}-->
     {% for j in user_maintenances %}
            <tr >
              <td class="counterCell"></td>
              <td>{{j[0]}}</td>
              <td>{{j[1]}} yr</td>
                 <td>{{j[2]}} {{currency}}</td>
                                 <td>{{j[3]}}</td>
                <td align="right"><a class="btn btn-outline-warning btn-sm" href='/form_page/{{j[4]}}/del_man'>Delete</a></td>
                 </tr>
     {% endfor %}
     </tbody>
        </table>
       <b>Total Maintenance Cost: {{session["main"]}} {{currency}}</b>
  </div>
     <div class="image_main">
    {% if mains[-1]==0 %}
    <div style="margin-left:300px; margin-top:300px;">No figure to display</div>
    {%else%}
<img src="{{url_for('static', filename='maintenance.png')}}" align="middle" width="1000" height="500"/>

    {%endif%}
    </div>
  <div class="input3">

    <legend align="left"><b>Operating points</b></legend>
        <form action="/form_page/add_point" method="POST" name="oper_points">
            <fieldset id="points">
    <div class="form-row">
    <div class="col-md-13 mb-3">
        <table>
            <tr>
                <td>    <div text-align="right"><input type="number" name="eff_driver" id="eff_driver" placeholder="Efficiency - Driver,%" min="0" max="100" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Efficiency - Driver,%'"></div></td>
            </tr>
            <tr>
                <td>    <input type="number" name="eff_other" id="eff_other" placeholder="Efficiency - Others,%" min="0" max="100" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Efficiency - Others,%'"></td>
            </tr>
            <tr>
                <td>   <input type="number" name="power_pump" id="power_pump" placeholder="Power Consump-Main,kW" min="0" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Power Consump-Main,kW'"></td>
            </tr>
            <tr>
                <td>    <input type="number" name="power_aux" id="power_aux" placeholder="Power Consump-Aux,kW" min="0" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Power Consump-Aux,kW'"></td>
            </tr>
<tr>
    <td>    <input type="number" name="scenario" id="scenario" placeholder="Oper. Scenario,months/year" min="0" max="12" step="1" class="form-control form-control-sm" onfocus="" onblur="this.placeholder='Oper. Scenario,months/year'">
</td>
</tr>

<tr><td>	<button type="submit" class="btn btn-outline-primary btn-sm" onclick="document.forms.oper_points.submit()">Add operating point</button>
</td><td></td></tr>
</table>
            </fieldset>
        </form>
  </div>
  <div class="tab3">
      <table class="table table-striped table-sm">
          <thead>
          <th scope="col"></th>
              <th scope="col">Efficiency - Driver, %</th>
                <th scope="col">Efficiency - Others, %</th>
                <th scope="col">Power Consumption-Main, kW</th>
                <th scope="col">Power Consumption-Auxilliaries, kW </th>
                <th scope="col">Operating Scenario, months / year</th>
                <th scope="col"></th>
          </thead>
     <tbody>
     {% for k in user_points %}
            <tr >
              <td class="counterCell"></td>
              <td>{{k[0]}}</td>
              <td>{{k[1]}}</td>
               <td>{{k[2]}}</td>
               <td>{{k[3]}}
               <td>{{k[4]}}</td>
                <td align="right"><a class="btn btn-outline-warning btn-sm" href='/form_page/{{k[5]}}/del_point'>Delete</a></td>
                 </tr>
     {% endfor %}
     <!--{% for k in points %}-->
            <!--<tr>-->
                <!--<td class="counterCell"></td>-->
                <!--<td> {{k.eff_driver}}</td>-->
                <!--<td> {{k.eff_other}}</td>-->
                <!--<td> {{k.power_pump}}</td>-->
                <!--<td> {{k.power_aux}}</td>-->
                <!--<td> {{k.scenario}}</td>-->
                <!--<td><a class="btn btn-warning" href='/form_page/{{k.id}}/del_point'>Delete</a></td>-->
            <!--</tr>-->
            <!--{% endfor %}-->
     </tbody>
        </table>
      <b>Total Energy Cost: {{energie}} {{currency}}</b>
      <div style="color:red">{{message}}</div>
  </div>

  <div class="image_energy">
    {% if costs[-1]==0 %}
    <div style="margin-left:300px; margin-top:300px;">No figure to display</div>
    {%else%}
<img src="{{url_for('static', filename='energy.png')}}" align="middle" width="1000" height="500"/>

    {%endif%}
    </div>


     <div class="input4">
<!--<fieldset id="economy" style="width:1200px" Grid.ColumnSpan="2">-->

    <form action="/form_page/add_general" method="POST" name="general">
    <table>


<tr>
      <td>
    <input type="text" name="project_name" id="project_name" placeholder="Project name" onfocus="this.placeholder='{{project_name}}'" onblur="this.placeholder='Project name'" class="form-control form-control-sm" >
 </td>
    <td>
    <input type="text" name="unit_name" id="unit_name" placeholder="Unit name" onfocus="this.placeholder='{{unit_name}}'" onblur="this.placeholder='Unit name'" class="form-control form-control-sm" >
 </td>
    <td>
    <input type="number" name="energy_price" id="energy_price" placeholder="Energy Price,{{currency}}/kWh" onfocus="this.placeholder='{{energy_price}}'" onblur="this.placeholder='Energy Price,{{currency}}/kWh'" min="0" step="0.01" class="form-control form-control-sm">
    </td>
    <td>
    <input type="number" name="annual_increase" id="annual_increase" placeholder="Annual Price Increase,%" onfocus="this.placeholder='{{annual_increase}}'" onblur="this.placeholder='Annual Price Increase,%'" min=0 step="0.01" class="form-control form-control-sm">
    </td>
    <td>
    <input type="number" name="number_years" id="number_years" placeholder="Number of years" onfocus="this.placeholder='{{number_years}}'" onblur="this.placeholder='Number of years'" min=0 step="1" class="form-control form-control-sm">
    </td>
    <td>
     <select class="form-select form-select-sm" name="currency" id="currency" aria-label=".form-select-sm example">
         <option value="{{currency}}" selected>{{currency}}</option>
         {%if currency== "$"%}
         <option value="€">€</option>
         <option value="₽">₽</option>
         <option value="¥">¥</option>
         {%endif%}
         {%if currency=="€"%}
         <option value="$">$</option>
         <option value="₽">₽</option>
         <option value="¥">¥</option>
         {%endif%}
         {%if currency=="₽"%}
         <option value="€">€</option>
         <option value="$">$</option>
         <option value="¥">¥</option>
         {%endif%}

         {%if currency=="¥"%}
         <option value="€">€</option>
         <option value="$">$</option>
         <option value="₽">₽</option>
         {%endif%}
  <!--<option value="$">$</option>-->
  <!--<option value="€">€</option>-->
  <!--<option value="₽">₽</option>-->
</select>
    </td>
    <td style="width:40px;">    </td>
    <td>
   <button type="submit" class="btn btn-primary btn-sm" onclick="document.forms.general.submit()">Update data</button>
</td>
</tr>



</table>
        </form>
     </div>

</section>
</div>
</div>
    <!--<script type ="text/javascript" src="https://cdn.anychart.com/releases/8.0.1/js/anychart-core.min.js"></script>-->
    <!--<script type ="text/javascript" src="https://cdn.anychart.com/releases/8.0.1/js/anychart-pie.min.js"></script>-->

<div id="capex_block" style="margin-left:30px; border:1px solid black;"><h3>Capex for project {{project_name}}, item {{unit_name}}</h3>
    <section class="container_capex">
  <div class="tab_capex">

  </div>
<div class="image_capex">
  </div>
 </section>

</div>

  <button id="toggle" onclick="changeclass(this);" class="btn btn-primary btn-sm" style="margin-left:30px; margin-bottom:30px;">Hide Capex block</button>
<script>
    const targetDiv = document.getElementById("capex_block");
    const targetDiv2 = document.getElementById("toggle");
const btn = document.getElementById("toggle");
btn.onclick = function () {
  if (targetDiv.style.display !== "none") {
    targetDiv.style.display = "none";
    targetDiv2.innerHTML="Show Capex block";
    targetDiv2.className="btn btn-primary btn-sm";
  } else {
    targetDiv.style.display = "block";
    targetDiv2.innerHTML="Hide Capex block";
    targetDiv2.className="btn btn-danger btn-sm";
  }
};

<!--function changeclass(element) {-->
    <!--$(element).toggleClass('btn btn-warning btn-sm');-->
<!--}-->
</script>
<p></p>
<div id="maintenance_block" style="margin-left:30px; border:1px solid black;" ><h3>Maintenance for project {{project_name}}, item {{unit_name}}</h3>
<section class="container_main">
  <div class="tab_main">

<table class="table table-striped table-sm" border="1px solid black" align="center">
  <th width="100px" class="text-center">Year</th><th width="100px" class="text-center">Maintenance Costs, {{currency}}</th>
  <tr align="middle">
    <td> {% for x in years %}
      {{ x }} <br>
    {% endfor %}</td>
    <td>
    {% for x in mains %}
 {{ x }} <br>
    {% endfor %}
    </td>
    </tr></table>
      <b>Total Maintenance Cost: {{main}} {{currency}}</b><br>
  </div>

  <div class="image_main">
    {% if mains[-1]==0 %}
    <div style="margin-left:300px; margin-top:300px;">No figure to display</div>
    {%else%}
<img src="{{url_for('static', filename='maintenance.png')}}" align="middle" width="1000" height="500"/>

    {%endif%}
    </div>
</section>

</div>

<div id=""printer"></div>
  <button id="toggle2" onclick="changeclass(this);" class="btn btn-primary btn-sm" style="margin-left:30px; margin-bottom:30px;">Hide Maintenance block</button>
<script>
    const targetDiv3 = document.getElementById("maintenance_block");
const btn2 = document.getElementById("toggle2");
btn2.onclick = function () {
  if (targetDiv3.style.display !== "none") {
    targetDiv3.style.display = "none";
    btn2.innerHTML="Show Maintenance block";
    btn2.className="btn btn-primary btn-sm";
  } else {
    targetDiv3.style.display = "block";
    btn2.innerHTML="Hide Maintenance block";
    btn2.className="btn btn-danger btn-sm";
  }
};

</script>
<div id="container4"></div>

<div id="energy_block" style="margin-left:30px; border:1px solid black;" ><h3>Energy evaluation for project {{project_name}}, item {{unit_name}}</h3>
    <p>Energy Price: {{energy_price}} {{currency}}/kWh</p>
<p>Annual Price Increase:  {{annual_increase}} %</p>
<section class="container_energy">
  <div class="tab_energy">

<!--<table class="table table-striped table-sm" border="1px solid black" align="center">-->
<table class="table table-striped table-sm" border="1px solid black" align="center">
  <th width="100px" class="text-center">Year</th><th width="100px" class="text-center">Energy Costs, {{currency}}</th>
  <tr align="middle">
    <td> {% for x in years %}
      {{ x }} <br>
    {% endfor %}</td>
    <td>
    {% for x in costs %}
 {{ x }} <br>
    {% endfor %}
    </td>
    </tr></table>


      <b>Energy Cost: {{main}} {{currency}}</b><br>
</div>
  <div class="image_energy">

    </div>
</section>

</div>

  <button id="toggle3" onclick="changeclass(this);" class="btn btn-primary btn-sm" style="margin-left:30px; margin-bottom:30px;">Hide Energy block</button>
<script>
    const targetDiv4 = document.getElementById("energy_block");
const btn3 = document.getElementById("toggle3");
btn3.onclick = function () {
  if (targetDiv4.style.display !== "none") {
    targetDiv4.style.display = "none";
    btn3.innerHTML="Show Energy block";
    btn3.className="btn btn-primary btn-sm";
  } else {
    targetDiv4.style.display = "block";
    btn3.innerHTML="Hide Energy block";
    btn3.className="btn btn-danger btn-sm";
  }
};


</script>
<div id="container5"></div>


<div style="margin-left:30px; margin-bottom:30px;"><button class="btn btn-danger btn-sm" onclick="window.open('','Select print option','width=400,height=400');">Create PDF</button></div>
<!--href='/create_pdf'-->
<div style="margin-left:30px; margin-bottom:30px;"><a class="btn btn-warning btn-sm" href='/reset'>Reset all inputs</a></div>



    {%endblock%}